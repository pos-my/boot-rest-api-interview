DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS books CASCADE;

CREATE TABLE users (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    username VARCHAR(50) NOT NULL,
    password VARCHAR(100) NOT NULL,
    firstname VARCHAR(100) DEFAULT NULL,
    lastname VARCHAR(100) DEFAULT NULL,
    status VARCHAR(20) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE roles (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    role VARCHAR(20) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE user_role (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    user_id BIGINT NOT NULL,
	role_id BIGINT NOT NULL,
	PRIMARY KEY (id),
	CONSTRAINT user_role_user_id FOREIGN KEY (user_id) REFERENCES users (id),
	CONSTRAINT user_role_role_id FOREIGN KEY (role_id) REFERENCES roles (id)
);

CREATE TABLE books (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    title VARCHAR(50) NOT NULL,
    author VARCHAR(50) DEFAULT NULL,
	borrower VARCHAR(50) DEFAULT NULL,
    status VARCHAR(20) NOT NULL,
    PRIMARY KEY (id)
);

INSERT INTO roles ( role ) VALUES
('LIBRARIAN'),
('MEMBER');

INSERT INTO users ( username, password, firstname, lastname, status ) VALUES 
('admin', '$2a$10$OJcswl1x4ronViiXRzRuO.Ng5IS98B9jHYjmb8cAZYw9ImSzR.Mf6', null, null, 'ACTIVE'), 
('user1', '$2a$10$/zmKHJ8SDtVsVAE6DHXk0.8AXuNNaB6TpHJZGo2WioZB9ilFy8BEW', null, null, 'ACTIVE'),
('user2', '$2a$10$/zmKHJ8SDtVsVAE6DHXk0.8AXuNNaB6TpHJZGo2WioZB9ilFy8BEW', null, null, 'ACTIVE');

INSERT INTO user_role (user_id, role_id) VALUES
(1, 1),
(1, 2),
(2, 2),
(3, 2);

INSERT INTO books ( title, author, borrower, status ) VALUES 
('book1', 'book1 Author', null, 'AVAILABLE'), 
('book2', 'book2 Author', null, 'AVAILABLE'), 
('book3', 'book3 Author', null, 'AVAILABLE');